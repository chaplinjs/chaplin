!function(){var a=function(){var a={},b={},c=function(){return function(){}},d=function(a,d){var e={id:a,exports:{}};d(e.exports,c(),e);var f=b[a]=e.exports;return f},e=function(c){if(b.hasOwnProperty(c))return b[c];if(a.hasOwnProperty(c))return d(c,a[c]);throw new Error('Cannot find module "'+c+'"')};return e.register=function(b,c){a[b]=c},e}();a.register("chaplin/application",function(b,c,d){"use strict";var e,f,g,h,i,j,k,l,m;m=a("underscore"),f=a("backbone"),h=a("chaplin/dispatcher"),j=a("chaplin/views/layout"),g=a("chaplin/composer"),k=a("chaplin/lib/router"),i=a("chaplin/lib/event_broker"),l=a("chaplin/mediator"),d.exports=e=function(){function a(a){null==a&&(a={}),this.initialize(a)}return a.extend=f.Model.extend,m.extend(a.prototype,i),a.prototype.title="",a.prototype.dispatcher=null,a.prototype.layout=null,a.prototype.router=null,a.prototype.composer=null,a.prototype.started=!1,a.prototype.initialize=function(a){if(null==a&&(a={}),this.started)throw new Error("Application#initialize: App was already started");return this.initRouter(a.routes,a),this.initDispatcher(a),this.initLayout(a),this.initComposer(a),this.initMediator(),this.start()},a.prototype.initDispatcher=function(a){return this.dispatcher=new h(a)},a.prototype.initLayout=function(a){return null==a&&(a={}),null==a.title&&(a.title=this.title),this.layout=new j(a)},a.prototype.initComposer=function(a){return null==a&&(a={}),this.composer=new g(a)},a.prototype.initMediator=function(){return l.seal()},a.prototype.initRouter=function(a,b){return this.router=new k(b),"function"==typeof a?a(this.router.match):void 0},a.prototype.start=function(){return this.router.startHistory(),this.started=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0},a.prototype.disposed=!1,a.prototype.dispose=function(){var a,b,c,d;if(!this.disposed){for(b=["dispatcher","layout","router","composer"],c=0,d=b.length;d>c;c++)a=b[c],null!=this[a]&&this[a].dispose();return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},a}()}),a.register("chaplin/mediator",function(b,c,d){"use strict";var e,f,g,h,i,j,k=[].slice;e=a("backbone"),j=a("underscore"),h=a("chaplin/lib/support"),i=a("chaplin/lib/utils"),g={},g.subscribe=g.on=e.Events.on,g.subscribeOnce=g.once=e.Events.once,g.unsubscribe=g.off=e.Events.off,g.publish=g.trigger=e.Events.trigger,g._callbacks=null,f=g._handlers={},g.setHandler=function(a,b,c){return f[a]={instance:c,method:b}},g.execute=function(){var a,b,c,d,e;if(d=arguments[0],a=2<=arguments.length?k.call(arguments,1):[],e=!1,"object"==typeof d?(e=d.silent,c=d.name):c=d,b=f[c])return b.method.apply(b.instance,a);if(!e)throw new Error("mediator.execute: "+c+" handler is not defined")},g.removeHandlers=function(a){var b,c,d,e;if(a||(g._handlers={}),i.isArray(a))for(d=0,e=a.length;e>d;d++)c=a[d],delete f[c];else for(c in f)b=f[c],b.instance===a&&delete f[c]},i.readonly(g,"subscribe","subscribeOnce","unsubscribe","publish","setHandler","execute","removeHandlers"),g.seal=function(){return h.propertyDescriptors&&Object.seal?Object.seal(g):void 0},i.readonly(g,"seal"),d.exports=g}),a.register("chaplin/dispatcher",function(b,c,d){"use strict";var e,f,g,h,i,j;j=a("underscore"),e=a("backbone"),h=a("chaplin/mediator"),i=a("chaplin/lib/utils"),g=a("chaplin/lib/event_broker"),d.exports=f=function(){function a(){this.initialize.apply(this,arguments)}return a.extend=e.Model.extend,j.extend(a.prototype,g),a.prototype.previousRoute=null,a.prototype.currentController=null,a.prototype.currentRoute=null,a.prototype.currentParams=null,a.prototype.currentQuery=null,a.prototype.initialize=function(a){return null==a&&(a={}),this.settings=j.defaults(a,{controllerPath:"controllers/",controllerSuffix:"_controller"}),this.subscribeEvent("router:match",this.dispatch)},a.prototype.dispatch=function(a,b,c){var d,e;return b=b?j.extend({},b):{},c=c?j.extend({},c):{},null==c.query&&(c.query={}),c.forceStartup!==!0&&(c.forceStartup=!1),!c.forceStartup&&(null!=(d=this.currentRoute)?d.controller:void 0)===a.controller&&(null!=(e=this.currentRoute)?e.action:void 0)===a.action&&j.isEqual(this.currentParams,b)&&j.isEqual(this.currentQuery,c.query)?void 0:this.loadController(a.controller,function(d){return function(e){return d.controllerLoaded(a,b,c,e)}}(this))},a.prototype.loadController=function(a,b){var c,d;return c=a+this.settings.controllerSuffix,d=this.settings.controllerPath+c,("undefined"!=typeof define&&null!==define?define.amd:void 0)?require([d],b):setTimeout(function(){return function(){return b(require(d))}}(this),0)},a.prototype.controllerLoaded=function(a,b,c,d){var e,f,g;return(this.nextPreviousRoute=this.currentRoute)&&(g=j.extend({},this.nextPreviousRoute),null!=this.currentParams&&(g.params=this.currentParams),g.previous&&delete g.previous,f={previous:g}),this.nextCurrentRoute=j.extend({},a,f),e=new d(b,this.nextCurrentRoute,c),this.executeBeforeAction(e,this.nextCurrentRoute,b,c)},a.prototype.executeAction=function(a,b,c,d){return this.currentController&&(this.publishEvent("beforeControllerDispose",this.currentController),this.currentController.dispose(c,b,d)),this.currentController=a,this.currentParams=j.clone(c),this.currentQuery=j.clone(d.query),a[b.action](c,b,d),a.redirected?void 0:this.publishEvent("dispatcher:dispatch",this.currentController,c,b,d)},a.prototype.executeBeforeAction=function(a,b,c,d){var e,f,g;if(e=a.beforeAction,f=function(e){return function(){return a.redirected||e.currentRoute&&b===e.currentRoute?(e.nextPreviousRoute=e.nextCurrentRoute=null,void a.dispose()):(e.previousRoute=e.nextPreviousRoute,e.currentRoute=e.nextCurrentRoute,e.nextPreviousRoute=e.nextCurrentRoute=null,e.executeAction(a,b,c,d))}}(this),!e)return void f();if("function"!=typeof e)throw new TypeError("Controller#beforeAction: function expected. Old object-like form is not supported.");return g=a.beforeAction(c,b,d),g&&g.then?g.then(f):f()},a.prototype.disposed=!1,a.prototype.dispose=function(){return this.disposed?void 0:(this.unsubscribeAllEvents(),this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0)},a}()}),a.register("chaplin/composer",function(b,c,d){"use strict";var e,f,g,h,i,j,k;k=a("underscore"),e=a("backbone"),i=a("chaplin/mediator"),j=a("chaplin/lib/utils"),g=a("chaplin/lib/composition"),h=a("chaplin/lib/event_broker"),d.exports=f=function(){function a(){this.initialize.apply(this,arguments)}return a.extend=e.Model.extend,k.extend(a.prototype,h),a.prototype.compositions=null,a.prototype.initialize=function(a){return null==a&&(a={}),this.compositions={},i.setHandler("composer:compose",this.compose,this),i.setHandler("composer:retrieve",this.retrieve,this),this.subscribeEvent("dispatcher:dispatch",this.cleanup)},a.prototype.compose=function(a,b,c){return"function"==typeof b?c||b.prototype.dispose?b.prototype instanceof g?this._compose(a,{composition:b,options:c}):this._compose(a,{options:c,compose:function(){var a,c;return this.item=b.prototype instanceof e.Model||b.prototype instanceof e.Collection?new b(null,this.options):new b(this.options),a=this.item.autoRender,c=void 0===a||!a,c&&"function"==typeof this.item.render?this.item.render():void 0}}):this._compose(a,{compose:b}):"function"==typeof c?this._compose(a,{compose:c,options:b}):this._compose(a,b)},a.prototype._compose=function(a,b){var c,d,e,f;if("function"!=typeof b.compose&&null==b.composition)throw new Error("Composer#compose was used incorrectly");return null!=b.composition?c=new b.composition(b.options):(c=new g(b.options),c.compose=b.compose,b.check&&(c.check=b.check)),d=this.compositions[a],e=!1,d&&d.check(c.options)?d.stale(!1):(d&&d.dispose(),f=c.compose(c.options),e="function"==typeof(null!=f?f.then:void 0),c.stale(!1),this.compositions[a]=c),e?f:this.compositions[a].item},a.prototype.retrieve=function(a){var b;return b=this.compositions[a],b&&!b.stale()?b.item:void 0},a.prototype.cleanup=function(){var a,b,c;c=this.compositions;for(b in c)a=c[b],a.stale()?(a.dispose(),delete this.compositions[b]):a.stale(!0)},a.prototype.dispose=function(){var a,b,c;if(!this.disposed){this.unsubscribeAllEvents(),i.removeHandlers(this),c=this.compositions;for(b in c)a=c[b],a.dispose();return delete this.compositions,this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},a}()}),a.register("chaplin/controllers/controller",function(b,c,d){"use strict";var e,f,g,h,i,j,k=[].slice,l={}.hasOwnProperty;j=a("underscore"),e=a("backbone"),g=a("chaplin/lib/event_broker"),i=a("chaplin/lib/utils"),h=a("chaplin/mediator"),d.exports=f=function(){function a(){this.initialize.apply(this,arguments)}return a.extend=e.Model.extend,j.extend(a.prototype,e.Events),j.extend(a.prototype,g),a.prototype.view=null,a.prototype.redirected=!1,a.prototype.initialize=function(){},a.prototype.beforeAction=function(){},a.prototype.adjustTitle=function(a){return h.execute("adjustTitle",a)},a.prototype.reuse=function(){var a;return a=1===arguments.length?"retrieve":"compose",h.execute.apply(h,["composer:"+a].concat(k.call(arguments)))},a.prototype.compose=function(){throw new Error("Controller#compose was moved to Controller#reuse")},a.prototype.redirectTo=function(a,b,c){return this.redirected=!0,i.redirectTo(a,b,c)},a.prototype.disposed=!1,a.prototype.dispose=function(){var a,b;if(!this.disposed){for(b in this)l.call(this,b)&&(a=this[b],a&&"function"==typeof a.dispose&&(a.dispose(),delete this[b]));return this.unsubscribeAllEvents(),this.stopListening(),this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},a}()}),a.register("chaplin/models/collection",function(b,c,d){"use strict";var e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),e=a("backbone"),g=a("chaplin/lib/event_broker"),h=a("chaplin/models/model"),i=a("chaplin/lib/utils"),d.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),j.extend(b.prototype,g),b.prototype.model=h,b.prototype.serialize=function(){return this.map(i.serialize)},b.prototype.disposed=!1,b.prototype.dispose=function(){var a,b,c,d;if(!this.disposed){for(this.trigger("dispose",this),this.reset([],{silent:!0}),this.unsubscribeAllEvents(),this.stopListening(),this.off(),b=["model","models","_byId","_byCid","_callbacks"],c=0,d=b.length;d>c;c++)a=b[c],delete this[a];return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},b}(e.Collection)}),a.register("chaplin/models/model",function(b,c,d){"use strict";var e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),e=a("backbone"),j=a("chaplin/lib/utils"),f=a("chaplin/lib/event_broker"),h=function(a,b,c){var d,f,g,h,k,l,m,n;d=j.beget(b),null==c&&(c={}),c[a.cid]=!0;for(f in b)if(k=b[f],k instanceof e.Model)d[f]=i(k,a,c);else if(k instanceof e.Collection){for(h=[],n=k.models,l=0,m=n.length;m>l;l++)g=n[l],h.push(i(g,a,c));d[f]=h}return delete c[a.cid],d},i=function(a,b,c){var d;return a===b||a.cid in c?null:(d="function"==typeof a.getAttributes?a.getAttributes():a.attributes,h(a,d,c))},d.exports=g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),k.extend(b.prototype,f),b.prototype.getAttributes=function(){return this.attributes},b.prototype.serialize=function(){return h(this,this.getAttributes())},b.prototype.disposed=!1,b.prototype.dispose=function(){var a,b,c,d;if(!this.disposed){for(this.trigger("dispose",this),this.unsubscribeAllEvents(),this.stopListening(),this.off(),b=["collection","attributes","changed","defaults","_escapedAttributes","_previousAttributes","_silent","_pending","_callbacks"],c=0,d=b.length;d>c;c++)a=b[c],delete this[a];return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},b}(e.Model)}),a.register("chaplin/views/layout",function(b,c,d){"use strict";var e,f,g,h,i,j,k,l,m=function(a,b){return function(){return a.apply(b,arguments)}},n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),f=a("backbone"),j=a("chaplin/mediator"),k=a("chaplin/lib/utils"),g=a("chaplin/lib/event_broker"),i=a("chaplin/views/view"),e=f.$,d.exports=h=function(a){function b(a){null==a&&(a={}),this.openLink=m(this.openLink,this),this.globalRegions=[],this.title=a.title,a.regions&&(this.regions=a.regions),this.settings=l.defaults(a,{titleTemplate:function(a){var b;return b=a.subtitle?""+a.subtitle+" – ":"",b+a.title},openExternalToBlank:!1,routeLinks:"a, .go-to",skipRouting:".noscript",scrollTo:[0,0]}),j.setHandler("region:show",this.showRegion,this),j.setHandler("region:register",this.registerRegionHandler,this),j.setHandler("region:unregister",this.unregisterRegionHandler,this),j.setHandler("region:find",this.regionByName,this),j.setHandler("adjustTitle",this.adjustTitle,this),b.__super__.constructor.apply(this,arguments),this.settings.routeLinks&&this.startLinkRouting()}return o(b,a),b.prototype.el="body",b.prototype.keepElement=!0,b.prototype.title="",b.prototype.globalRegions=null,b.prototype.listen={"beforeControllerDispose mediator":"scroll"},b.prototype.scroll=function(){var a;return a=this.settings.scrollTo,a?window.scrollTo(a[0],a[1]):void 0},b.prototype.adjustTitle=function(a){var b;return null==a&&(a=""),b=this.settings.titleTemplate({title:this.title,subtitle:a}),setTimeout(function(c){return function(){return document.title=b,c.publishEvent("adjustTitle",a,b)}}(this),50),b},b.prototype.startLinkRouting=function(){var a;return(a=this.settings.routeLinks)?e?this.$el.on("click",a,this.openLink):this.delegate("click",a,this.openLink):void 0},b.prototype.stopLinkRouting=function(){var a;return a=this.settings.routeLinks,e?a?this.$el.off("click",a):void 0:this.undelegate("click",a,this.openLink)},b.prototype.isExternalLink=function(a){var b,c;return"_blank"===a.target||"external"===a.rel||"http:"!==(b=a.protocol)&&"https:"!==b&&"file:"!==b||(c=a.hostname)!==location.hostname&&""!==c},b.prototype.openLink=function(a){var b,c,d,g,h,i;if(!(k.modifierKeyPressed(a)||(b=e?a.currentTarget:a.delegateTarget,g="A"===b.nodeName,d=b.getAttribute("href")||b.getAttribute("data-href")||null,null==d||""===d||"#"===d.charAt(0)||(h=this.settings.skipRouting,i=typeof h,"function"===i&&!h(d,b)||"string"===i&&(e?e(b).is(h):f.utils.matchesSelector(b,h)))))){if(c=g&&this.isExternalLink(b))return void(this.settings.openExternalToBlank&&(a.preventDefault(),window.open(d)));k.redirectTo({url:d}),a.preventDefault()}},b.prototype.registerRegionHandler=function(a,b,c){return null!=b?this.registerGlobalRegion(a,b,c):this.registerGlobalRegions(a)},b.prototype.registerGlobalRegion=function(a,b,c){return this.unregisterGlobalRegion(a,b),this.globalRegions.unshift({instance:a,name:b,selector:c})},b.prototype.registerGlobalRegions=function(a){var b,c,d,e,f,g;for(g=k.getAllPropertyVersions(a,"regions"),e=0,f=g.length;f>e;e++){d=g[e];for(b in d)c=d[b],this.registerGlobalRegion(a,b,c)}},b.prototype.unregisterRegionHandler=function(a,b){return null!=b?this.unregisterGlobalRegion(a,b):this.unregisterGlobalRegions(a)},b.prototype.unregisterGlobalRegion=function(a,b){var c,d;return c=a.cid,this.globalRegions=function(){var a,e,f,g;for(f=this.globalRegions,g=[],a=0,e=f.length;e>a;a++)d=f[a],(d.instance.cid!==c||d.name!==b)&&g.push(d);return g}.call(this)},b.prototype.unregisterGlobalRegions=function(a){var b;return this.globalRegions=function(){var c,d,e,f;for(e=this.globalRegions,f=[],c=0,d=e.length;d>c;c++)b=e[c],b.instance.cid!==a.cid&&f.push(b);return f}.call(this)},b.prototype.regionByName=function(a){var b,c,d,e;for(e=this.globalRegions,c=0,d=e.length;d>c;c++)if(b=e[c],b.name===a&&!b.instance.stale)return b},b.prototype.showRegion=function(a,b){var c;if(c=this.regionByName(a),!c)throw new Error("No region registered under "+a);return b.container=""===c.selector?e?c.instance.$el:c.instance.el:c.instance.noWrap?e?e(c.instance.container).find(c.selector):c.instance.container.querySelector(c.selector):c.instance[e?"$":"find"](c.selector)},b.prototype.dispose=function(){var a,c,d,e;if(!this.disposed){for(this.stopLinkRouting(),e=["globalRegions","title","route"],c=0,d=e.length;d>c;c++)a=e[c],delete this[a];return j.removeHandlers(this),b.__super__.dispose.apply(this,arguments)}},b}(i)}),a.register("chaplin/views/view",function(b,c,d){"use strict";var e,f,g,h,i,j,k,l,m,n,o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},q=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};n=a("underscore"),f=a("backbone"),k=a("chaplin/mediator"),g=a("chaplin/lib/event_broker"),m=a("chaplin/lib/utils"),e=f.$,j=function(){return Function.prototype.bind?function(a,b){return a.bind(b)}:n.bind?n.bind:void 0}(),l=function(){return e?function(a,b){return a.html(b)}:function(a,b){return a.innerHTML=b}}(),i=function(){return e?function(a){var b;return b=e(a.container),"function"==typeof a.containerMethod?a.containerMethod(b,a.el):b[a.containerMethod](a.el)}:function(a){var b;return b="string"==typeof a.container?document.querySelector(a.container):a.container,"function"==typeof a.containerMethod?a.containerMethod(b,a.el):b[a.containerMethod](a.el)}}(),d.exports=h=function(a){function b(a){var c,d,f,g;if(a)for(c in a)d=a[c],q.call(this.optionNames,c)>=0&&(this[c]=d);g=this.render,this.render=function(a){return function(){return a.disposed?!1:(g.apply(a,arguments),a.autoAttach&&a.attach.apply(a,arguments),a)}}(this),this.subviews=[],this.subviewsByName={},this.noWrap&&(this.region&&(f=k.execute("region:find",this.region),null!=f&&(this.el=null!=f.instance.container?null!=f.instance.region?e(f.instance.container).find(f.selector):f.instance.container:f.instance.$(f.selector))),this.container&&(this.el=this.container)),b.__super__.constructor.apply(this,arguments),this.delegateListeners(),this.model&&this.listenTo(this.model,"dispose",this.dispose),this.collection&&this.listenTo(this.collection,"dispose",function(a){return function(b){return b&&b!==a.collection?void 0:a.dispose()}}(this)),null!=this.regions&&k.execute("region:register",this),this.autoRender&&this.render()}return p(b,a),n.extend(b.prototype,g),b.prototype.autoRender=!1,b.prototype.autoAttach=!0,b.prototype.container=null,b.prototype.containerMethod=e?"append":"appendChild",b.prototype.regions=null,b.prototype.region=null,b.prototype.stale=!1,b.prototype.noWrap=!1,b.prototype.keepElement=!1,b.prototype.subviews=null,b.prototype.subviewsByName=null,b.prototype.optionNames=["autoAttach","autoRender","container","containerMethod","region","regions","noWrap"],b.prototype.delegate=function(a,b,c){var d,e,g,h,i,k;if(f.utils)return f.utils.delegate(this,a,b,c);if("string"!=typeof a)throw new TypeError("View#delegate: first argument must be a string");if(2===arguments.length)h=b;else{if(3!==arguments.length)throw new TypeError("View#delegate: only two or three arguments are allowed");if(k=b,"string"!=typeof k)throw new TypeError("View#delegate: second argument must be a string");h=c}if("function"!=typeof h)throw new TypeError("View#delegate: handler argument must be function");return i=function(){var b,c,d,f;for(d=a.split(" "),f=[],b=0,c=d.length;c>b;b++)e=d[b],f.push(""+e+".delegate"+this.cid);return f}.call(this),g=i.join(" "),d=j(h,this),this.$el.on(g,k||null,d),d},b.prototype._delegateEvents=function(a){var b,c,d,e,g,h,i;if(2===f.View.prototype.delegateEvents.length)return f.View.prototype.delegateEvents.call(this,a,!0);for(e in a){if(i=a[e],d="function"==typeof i?i:this[i],!d)throw new Error("Method '"+i+"' does not exist");g=e.match(/^(\S+)\s*(.*)$/),c=""+g[1]+".delegateEvents"+this.cid,h=g[2],b=j(d,this),this.$el.on(c,h||null,b)}},b.prototype.delegateEvents=function(a,b){var c,d,e,f;if(b||this.undelegateEvents(),a)return this._delegateEvents(a);for(f=m.getAllPropertyVersions(this,"events"),d=0,e=f.length;e>d;d++)c=f[d],"function"==typeof c&&(c=c.call(this)),this._delegateEvents(c)},b.prototype.undelegate=function(a,b,c){var d,e,g,h,i;if(f.utils)return f.utils.undelegate(this,a,b,c);if(a){if("string"!=typeof a)throw new TypeError("View#undelegate: first argument must be a string");if(2===arguments.length)"string"==typeof b?i=b:g=b;else if(3===arguments.length){if(i=b,"string"!=typeof i)throw new TypeError("View#undelegate: second argument must be a string");g=c}return h=function(){var b,c,e,f;for(e=a.split(" "),f=[],b=0,c=e.length;c>b;b++)d=e[b],f.push(""+d+".delegate"+this.cid);return f}.call(this),e=h.join(" "),this.$el.off(e,i||null)}return this.$el.off(".delegate"+this.cid)},b.prototype.delegateListeners=function(){var a,b,c,d,e,f,g,h,i;if(this.listen)for(h=m.getAllPropertyVersions(this,"listen"),f=0,g=h.length;g>f;f++){e=h[f],"function"==typeof e&&(e=e.call(this));for(b in e){if(c=e[b],"function"!=typeof c&&(c=this[c]),"function"!=typeof c)throw new Error("View#delegateListeners: "+('listener for "'+b+'" must be function'));i=b.split(" "),a=i[0],d=i[1],this.delegateListener(a,d,c)}}},b.prototype.delegateListener=function(a,b,c){var d;"model"===b||"collection"===b?(d=this[b],d&&this.listenTo(d,a,c)):"mediator"===b?this.subscribeEvent(a,c):b||this.on(a,c,this)},b.prototype.registerRegion=function(a,b){return k.execute("region:register",this,a,b)},b.prototype.unregisterRegion=function(a){return k.execute("region:unregister",this,a)},b.prototype.unregisterAllRegions=function(){return k.execute({name:"region:unregister",silent:!0},this)},b.prototype.subview=function(a,b){var c,d;return d=this.subviews,c=this.subviewsByName,a&&b?(this.removeSubview(a),d.push(b),c[a]=b,b):a?c[a]:void 0},b.prototype.removeSubview=function(a){var b,c,d,e,f,g,h;if(a){if(g=this.subviews,b=this.subviewsByName,"string"==typeof a)d=a,h=b[d];else{h=a;for(e in b)if(f=b[e],f===h){d=e;break}}if(d&&h&&h.dispose)return h.dispose(),c=m.indexOf(g,h),-1!==c&&g.splice(c,1),delete b[d]}},b.prototype.getTemplateData=function(){var a,b;return a=this.model?m.serialize(this.model):this.collection?{items:m.serialize(this.collection),length:this.collection.length}:{},b=this.model||this.collection,b&&("function"!=typeof b.isSynced||"synced"in a||(a.synced=b.isSynced())),a},b.prototype.getTemplateFunction=function(){throw new Error("View#getTemplateFunction must be overridden")},b.prototype.render=function(){var a,b,c;if(this.disposed)return!1;if(c=this.getTemplateFunction(),"function"==typeof c)if(b=c(this.getTemplateData()),this.noWrap){if(a=document.createElement("div"),a.innerHTML=b,a.children.length>1)throw new Error("There must be a single top-level element when using `noWrap`.");this.undelegateEvents(),this.setElement(a.firstChild,!0)}else l(e?this.$el:this.el,b);return this},b.prototype.attach=function(){return null!=this.region&&k.execute("region:show",this.region,this),this.container&&!document.body.contains(this.el)?(i(this),this.trigger("addedToDOM")):void 0},b.prototype.disposed=!1,b.prototype.dispose=function(){var a,b,c,d,e,f,g,h;if(!this.disposed){for(this.unregisterAllRegions(),h=this.subviews,d=0,f=h.length;f>d;d++)c=h[d],c.dispose();for(this.unsubscribeAllEvents(),this.off(),this.keepElement?(this.undelegateEvents(),this.undelegate(),this.stopListening()):this.remove(),b=["el","$el","options","model","collection","subviews","subviewsByName","_callbacks"],e=0,g=b.length;g>e;e++)a=b[e],delete this[a];return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},b}(f.View)}),a.register("chaplin/views/collection_view",function(b,c,d){"use strict";var e,f,g,h,i,j,k,l,m,n,o,p,q=function(a,b){return function(){return a.apply(b,arguments)}},r={}.hasOwnProperty,s=function(a,b){function c(){this.constructor=a}for(var d in b)r.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};p=a("underscore"),f=a("backbone"),h=a("chaplin/views/view"),o=a("chaplin/lib/utils"),e=f.$,k=function(a,b){var c,d,e,g;if(!b)return a;for(g=[],d=0,e=a.length;e>d;d++)c=a[d],f.utils.matchesSelector(c,b)&&g.push(c);return g},n=function(){return e?function(a,b){return a.toggle(b)}:function(a,b){return a.style.display=b?"":"none"}}(),i=function(){return e?function(a,b){return a.addClass(b)}:function(a,b){return a.classList.add(b)}}(),m=function(){return e?function(a,b,c){return b?i(a,c):a.css("opacity",0)}:function(a,b,c){return b?i(a,c):a.style.opacity=0}}(),j=function(){return e?function(a,b){return a.animate({opacity:1},b)}:function(a,b){return a.style.transition="opacity "+b/1e3+"s",a.style.opacity=1}}(),l=function(){return e?function(a,b,c,d,e){var f,g,h,i,j;return h=c>0&&d>c,i=function(a){return 0===a||c===a},h||e?(f=a.children(e),g=f.length,f[c]!==b?i(g)?a.append(b):0===c?f.eq(c).before(b):f.eq(c-1).after(b):void 0):(j=i(d)?"append":"prepend",a[j](b))}:function(a,b,c,d,e){var f,g,h,i,j;return h=c>0&&d>c,i=function(a){return 0===a||c===a},h||e?(f=k(a.children,e),g=f.length,f[c]!==b?i(g)?a.appendChild(b):0===c?a.insertBefore(b,f[c]):(j=f[c-1],a.lastChild===j?a.appendChild(b):a.insertBefore(b,j.nextElementSibling)):void 0):i(d)?a.appendChild(b):a.insertBefore(b,a.firstChild)}}(),d.exports=g=function(a){function b(){this.renderAllItems=q(this.renderAllItems,this),this.toggleFallback=q(this.toggleFallback,this),this.itemsReset=q(this.itemsReset,this),this.itemRemoved=q(this.itemRemoved,this),this.itemAdded=q(this.itemAdded,this),this.visibleItems=[],b.__super__.constructor.apply(this,arguments)}return s(b,a),b.prototype.itemView=null,b.prototype.autoRender=!0,b.prototype.renderItems=!0,b.prototype.animationDuration=500,b.prototype.useCssAnimation=!1,b.prototype.animationStartClass="animated-item-view",b.prototype.animationEndClass="animated-item-view-end",b.prototype.listSelector=null,b.prototype.$list=null,b.prototype.fallbackSelector=null,b.prototype.$fallback=null,b.prototype.loadingSelector=null,b.prototype.$loading=null,b.prototype.itemSelector=null,b.prototype.filterer=null,b.prototype.filterCallback=function(a,b){return e&&a.$el.stop(!0,!0),n(e?a.$el:a.el,b)},b.prototype.visibleItems=null,b.prototype.optionNames=h.prototype.optionNames.concat(["renderItems","itemView"]),b.prototype.initialize=function(a){return null==a&&(a={}),this.addCollectionListeners(),null!=a.filterer?this.filter(a.filterer):void 0},b.prototype.addCollectionListeners=function(){return this.listenTo(this.collection,"add",this.itemAdded),this.listenTo(this.collection,"remove",this.itemRemoved),this.listenTo(this.collection,"reset sort",this.itemsReset)},b.prototype.getTemplateData=function(){var a;return a={length:this.collection.length},"function"==typeof this.collection.isSynced&&(a.synced=this.collection.isSynced()),a},b.prototype.getTemplateFunction=function(){},b.prototype.render=function(){var a;return b.__super__.render.apply(this,arguments),a=p.result(this,"listSelector"),e?this.$list=a?this.$(a):this.$el:this.list=a?this.find(this.listSelector):this.el,this.initFallback(),this.initLoadingIndicator(),this.renderItems?this.renderAllItems():void 0},b.prototype.itemAdded=function(a,b,c){return this.insertView(a,this.renderItem(a),c.at)},b.prototype.itemRemoved=function(a){return this.removeViewForItem(a)},b.prototype.itemsReset=function(){return this.renderAllItems()},b.prototype.initFallback=function(){return this.fallbackSelector?(e?this.$fallback=this.$(this.fallbackSelector):this.fallback=this.find(this.fallbackSelector),this.on("visibilityChange",this.toggleFallback),this.listenTo(this.collection,"syncStateChange",this.toggleFallback),this.toggleFallback()):void 0},b.prototype.toggleFallback=function(){var a;return a=0===this.visibleItems.length&&("function"==typeof this.collection.isSynced?this.collection.isSynced():!0),n(e?this.$fallback:this.fallback,a)},b.prototype.initLoadingIndicator=function(){return this.loadingSelector&&"function"==typeof this.collection.isSyncing?(e?this.$loading=this.$(this.loadingSelector):this.loading=this.find(this.loadingSelector),this.listenTo(this.collection,"syncStateChange",this.toggleLoadingIndicator),this.toggleLoadingIndicator()):void 0},b.prototype.toggleLoadingIndicator=function(){var a;return a=0===this.collection.length&&this.collection.isSyncing(),n(e?this.$loading:this.loading,a)},b.prototype.getItemViews=function(){var a,b,c,d;if(a={},this.subviews.length>0){d=this.subviewsByName;for(b in d)c=d[b],"itemView:"===b.slice(0,9)&&(a[b.slice(9)]=c)}return a},b.prototype.filter=function(a,b){var c,d,e,f,g,h,i,j;if(("function"==typeof a||null===a)&&(this.filterer=a),("function"==typeof b||null===b)&&(this.filterCallback=b),c=function(a){return function(){var b;if(a.subviews.length>0)for(b in a.subviewsByName)if("itemView:"===b.slice(0,9))return!0;return!1}}(this)())for(j=this.collection.models,e=h=0,i=j.length;i>h;e=++h){if(f=j[e],d="function"==typeof this.filterer?this.filterer(f,e):!0,g=this.subview("itemView:"+f.cid),!g)throw new Error("CollectionView#filter: no view found for "+f.cid);this.filterCallback(g,d),this.updateVisibleItems(g.model,d,!1)}return this.trigger("visibilityChange",this.visibleItems)},b.prototype.renderAllItems=function(){var a,b,c,d,e,f,g,h,i,j,k;for(d=this.collection.models,this.visibleItems=[],e={},g=0,i=d.length;i>g;g++)c=d[g],f=this.subview("itemView:"+c.cid),f&&(e[c.cid]=f);k=this.getItemViews();for(a in k)r.call(k,a)&&(f=k[a],a in e||this.removeSubview("itemView:"+a));for(b=h=0,j=d.length;j>h;b=++h)c=d[b],f=this.subview("itemView:"+c.cid),f?this.insertView(c,f,b,!1):this.insertView(c,this.renderItem(c),b);return 0===d.length?this.trigger("visibilityChange",this.visibleItems):void 0},b.prototype.renderItem=function(a){var b;return b=this.subview("itemView:"+a.cid),b||(b=this.initItemView(a),this.subview("itemView:"+a.cid,b)),b.render(),b},b.prototype.initItemView=function(a){if(this.itemView)return new this.itemView({autoRender:!1,model:a});throw new Error("The CollectionView#itemView property must be defined or the initItemView() must be overridden.")},b.prototype.insertView=function(a,b,c,d){var f,g,h,k;return null==d&&(d=!0),0===this.animationDuration&&(d=!1),"number"!=typeof c&&(c=this.collection.indexOf(a)),g="function"==typeof this.filterer?this.filterer(a,c):!0,f=e?b.$el:b.el,g&&d&&m(f,this.useCssAnimation,this.animationStartClass),this.filterer&&this.filterCallback(b,g),h=this.collection.length,k=e?this.$list:this.list,l(k,f,c,h,this.itemSelector),b.trigger("addedToParent"),this.updateVisibleItems(a,g),g&&d&&(this.useCssAnimation?setTimeout(function(a){return function(){return i(f,a.animationEndClass)}}(this),0):j(f,this.animationDuration)),b},b.prototype.removeViewForItem=function(a){return this.updateVisibleItems(a,!1),this.removeSubview("itemView:"+a.cid)},b.prototype.updateVisibleItems=function(a,b,c){var d,e,f;return null==c&&(c=!0),e=!1,f=o.indexOf(this.visibleItems,a),d=-1!==f,b&&!d?(this.visibleItems.push(a),e=!0):!b&&d&&(this.visibleItems.splice(f,1),e=!0),e&&c&&this.trigger("visibilityChange",this.visibleItems),e},b.prototype.dispose=function(){var a,c,d,e;if(!this.disposed){for(c=["$list","$fallback","$loading","visibleItems"],d=0,e=c.length;e>d;d++)a=c[d],delete this[a];return b.__super__.dispose.apply(this,arguments)}},b}(h)}),a.register("chaplin/lib/route",function(b,c,d){"use strict";var e,f,g,h,i,j,k=function(a,b){return function(){return a.apply(b,arguments)}},l={}.hasOwnProperty;j=a("underscore"),e=a("backbone"),g=a("chaplin/lib/event_broker"),f=a("chaplin/controllers/controller"),i=a("chaplin/lib/utils"),d.exports=h=function(){function a(a,b,c,d){if(this.pattern=a,this.controller=b,this.action=c,this.handler=k(this.handler,this),this.replaceParams=k(this.replaceParams,this),this.parseOptionalPortion=k(this.parseOptionalPortion,this),"string"!=typeof this.pattern)throw new Error("Route: RegExps are not supported. Use strings with :names and `constraints` option of route");
if(this.options=d?j.extend({},d):{},this.options.paramsInQS!==!1&&(this.options.paramsInQS=!0),null!=this.options.name&&(this.name=this.options.name),this.name&&-1!==this.name.indexOf("#"))throw new Error('Route: "#" cannot be used in name');if(null==this.name&&(this.name=this.controller+"#"+this.action),this.allParams=[],this.requiredParams=[],this.optionalParams=[],this.action in f.prototype)throw new Error("Route: You should not use existing controller properties as action names");this.createRegExp(),"function"==typeof Object.freeze&&Object.freeze(this)}var b,c,d,h;return a.extend=e.Model.extend,j.extend(a.prototype,g),b=/[\-{}\[\]+?.,\\\^$|#\s]/g,c=/\((.*?)\)/g,d=/(?::|\*)(\w+)/g,h=function(a,b){switch(b){case!0:"/"!==a.slice(-1)&&(a+="/");break;case!1:"/"===a.slice(-1)&&(a=a.slice(0,-1))}return a},a.prototype.matches=function(a){var b,c,d,e,f,g,h;if("string"==typeof a)return a===this.name;for(d=0,h=["name","action","controller"],f=0,g=h.length;g>f;f++)if(c=h[f],d++,e=a[c],e&&e!==this[c])return!1;return b=1===d&&("action"===c||"controller"===c),!b},a.prototype.reverse=function(a,b){var d,e,f,g,k,l,m,n,o,p,q;if(a=this.normalizeParams(a),f=j.extend({},a),a===!1)return!1;for(g=this.pattern,p=this.requiredParams,l=0,n=p.length;n>l;l++)d=p[l],k=a[d],g=g.replace(RegExp("[:*]"+d,"g"),k),delete f[d];for(q=this.optionalParams,m=0,o=q.length;o>m;m++)d=q[m],(k=a[d])&&(g=g.replace(RegExp("[:*]"+d,"g"),k),delete f[d]);return e=g.replace(c,function(a,b){return b.match(/[:*]/g)?"":b}),g=h(e,this.options.trailing),"object"!=typeof b&&(b=i.queryParams.parse(b)),this.options.paramsInQS!==!1&&j.extend(b,f),j.isEmpty(b)||(g+="?"+i.queryParams.stringify(b)),g},a.prototype.normalizeParams=function(a){var b,c,d,e,f,g;if(i.isArray(a)){if(a.length<this.requiredParams.length)return!1;for(d={},e=this.requiredParams.concat(this.optionalParams),b=f=0,g=a.length-1;g>=f;b=f+=1)c=e[b],d[c]=a[b];if(!this.testConstraints(d))return!1;a=d}else if(null==a&&(a={}),!this.testParams(a))return!1;return a},a.prototype.testConstraints=function(a){var b,c,d;if(c=this.options.constraints)for(d in c)if(l.call(c,d)&&(b=c[d],!b.test(a[d])))return!1;return!0},a.prototype.testParams=function(a){var b,c,d,e;for(e=this.requiredParams,c=0,d=e.length;d>c;c++)if(b=e[c],void 0===a[b])return!1;return this.testConstraints(a)},a.prototype.createRegExp=function(){var a;return a=this.pattern,a=a.replace(b,"\\$&"),this.replaceParams(a,function(a){return function(b,c){return a.allParams.push(c)}}(this)),a=a.replace(c,this.parseOptionalPortion),a=this.replaceParams(a,function(a){return function(b,c){return a.requiredParams.push(c),a.paramCapturePattern(b)}}(this)),this.regExp=RegExp("^"+a+"(?=/*(?=\\?|$))")},a.prototype.parseOptionalPortion=function(a,b){var c;return c=this.replaceParams(b,function(a){return function(b,c){return a.optionalParams.push(c),a.paramCapturePattern(b)}}(this)),"(?:"+c+")?"},a.prototype.replaceParams=function(a,b){return a.replace(d,b)},a.prototype.paramCapturePattern=function(a){return":"===a.charAt(0)?"([^/?]+)":"(.*?)"},a.prototype.test=function(a){var b,c;return(c=this.regExp.test(a))?(b=this.options.constraints,b?this.testConstraints(this.extractParams(a)):!0):!1},a.prototype.handler=function(a,b){var c,d,e,f,g,k;return b=b?j.extend({},b):{},"object"==typeof a?(f=i.queryParams.stringify(b.query),d=a,e=this.reverse(d)):(k=a.split("?"),e=k[0],f=k[1],null==f?f="":b.query=i.queryParams.parse(f),d=this.extractParams(e),e=h(e,this.options.trailing)),c=j.extend({},d,this.options.params),g={path:e,action:this.action,controller:this.controller,name:this.name,query:f},this.publishEvent("router:match",g,c,b)},a.prototype.extractParams=function(a){var b,c,d,e,f,g,h,i;for(f={},d=this.regExp.exec(a),i=d.slice(1),b=g=0,h=i.length;h>g;b=++g)c=i[b],e=this.allParams.length?this.allParams[b]:b,f[e]=c;return f},a}()}),a.register("chaplin/lib/router",function(b,c,d){"use strict";var e,f,g,h,i,j,k,l,m=function(a,b){return function(){return a.apply(b,arguments)}};l=a("underscore"),e=a("backbone"),j=a("chaplin/mediator"),f=a("chaplin/lib/event_broker"),g=a("chaplin/lib/history"),h=a("chaplin/lib/route"),k=a("chaplin/lib/utils"),d.exports=i=function(){function a(a){var b;this.options=null!=a?a:{},this.match=m(this.match,this),b="file:"!==window.location.protocol,l.defaults(this.options,{pushState:b,root:"/",trailing:!1}),this.removeRoot=new RegExp("^"+k.escapeRegExp(this.options.root)+"(#)?"),this.subscribeEvent("!router:route",this.oldEventError),this.subscribeEvent("!router:routeByName",this.oldEventError),this.subscribeEvent("!router:changeURL",this.oldURLEventError),this.subscribeEvent("dispatcher:dispatch",this.changeURL),j.setHandler("router:route",this.route,this),j.setHandler("router:reverse",this.reverse,this),this.createHistory()}return a.extend=e.Model.extend,l.extend(a.prototype,f),a.prototype.oldEventError=function(){throw new Error("!router:route and !router:routeByName events were removed. Use `Chaplin.utils.redirectTo`")},a.prototype.oldURLEventError=function(){throw new Error("!router:changeURL event was removed.")},a.prototype.createHistory=function(){return e.history=new g},a.prototype.startHistory=function(){return e.history.start(this.options)},a.prototype.stopHistory=function(){return e.History.started?e.history.stop():void 0},a.prototype.findHandler=function(a){var b,c,d,f;for(f=e.history.handlers,c=0,d=f.length;d>c;c++)if(b=f[c],a(b))return b},a.prototype.match=function(a,b,c){var d,f,g,i;if(null==c&&(c={}),2===arguments.length&&"object"==typeof b){if(c=b,f=c.controller,d=c.action,!f||!d)throw new Error("Router#match must receive either target or options.controller & options.action")}else{if(f=c.controller,d=c.action,f||d)throw new Error("Router#match cannot use both target and options.controller / options.action");i=b.split("#"),f=i[0],d=i[1]}return l.defaults(c,{trailing:this.options.trailing}),g=new h(a,f,d,c),e.history.handlers.push({route:g,callback:g.handler}),g},a.prototype.route=function(a,b,c){var d,e,f;if("object"==typeof a&&(e=a.url,!b&&a.params&&(b=a.params)),b=b?k.isArray(b)?b.slice():l.extend({},b):{},null!=e?(e=e.replace(this.removeRoot,""),d=this.findHandler(function(a){return a.route.test(e)}),c=b,b=null):(c=c?l.extend({},c):{},d=this.findHandler(function(c){return c.route.matches(a)&&(b=c.route.normalizeParams(b))?!0:!1})),d)return l.defaults(c,{changeURL:!0}),f=null!=e?e:b,d.callback(f,c),!0;throw new Error("Router#route: request was not routed")},a.prototype.reverse=function(a,b,c){var d,f,g,h,i,j,k;if(h=this.options.root,null!=b&&"object"!=typeof b)throw new TypeError("Router#reverse: params must be an array or an object");for(f=e.history.handlers,j=0,k=f.length;k>j;j++)if(d=f[j],d.route.matches(a)&&(g=d.route.reverse(b,c),g!==!1))return i=h?h+g:g;throw new Error("Router#reverse: invalid route criteria specified: "+JSON.stringify(a))},a.prototype.changeURL=function(a,b,c,d){var f,g;if(null!=c.path&&d.changeURL)return g=c.path+(c.query?"?"+c.query:""),f={trigger:d.trigger===!0,replace:d.replace===!0},e.history.navigate(g,f)},a.prototype.disposed=!1,a.prototype.dispose=function(){return this.disposed?void 0:(this.stopHistory(),delete e.history,this.unsubscribeAllEvents(),j.removeHandlers(this),this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0)},a}()}),a.register("chaplin/lib/history",function(b,c,d){"use strict";var e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),e=a("backbone"),i=/^[#\/]|\s+$/g,h=/^\/+|\/+$/g,g=/msie [\w.]+/,j=/\/$/,f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.getFragment=function(a,b){var c;return null==a&&(this._hasPushState||!this._wantsHashChange||b?(a=this.location.pathname+this.location.search,c=this.root.replace(j,""),a.indexOf(c)||(a=a.substr(c.length))):a=this.getHash()),a.replace(i,"")},b.prototype.start=function(a){var b,c,d,f,g;if(e.History.started)throw new Error("Backbone.history has already been started");return e.History.started=!0,this.options=k.extend({},{root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=Boolean(this.options.pushState),this._hasPushState=Boolean(this.options.pushState&&this.history&&this.history.pushState),c=this.getFragment(),i=null!=(f=this.options.routeStripper)?f:i,h=null!=(g=this.options.rootStripper)?g:h,this.root=("/"+this.root+"/").replace(h,"/"),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=c,d=this.location,b=d.pathname.replace(/[^\/]$/,"$&/")===this.root,this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&b&&d.hash&&(this.fragment=this.getHash().replace(i,""),this.history.replaceState({},document.title,this.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},b.prototype.navigate=function(a,b){var c,d,f;if(null==a&&(a=""),!e.History.started)return!1;if(b&&b!==!0||(b={trigger:b}),a=this.getFragment(a),f=this.root+a,this.fragment===a)return!1;if(this.fragment=a,0===a.length&&f!==this.root&&(f=f.slice(0,-1)),this._hasPushState)c=b.replace?"replaceState":"pushState",this.history[c]({},document.title,f);else{if(!this._wantsHashChange)return this.location.assign(f);this._updateHash(this.location,a,b.replace),d=a!==this.getFragment(this.getHash(this.iframe)),null!=this.iframe&&d&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0},b}(e.History),d.exports=e.$?f:e.History}),a.register("chaplin/lib/event_broker",function(b,c,d){"use strict";var e,f,g=[].slice;f=a("chaplin/mediator"),e={subscribeEvent:function(a,b){if("string"!=typeof a)throw new TypeError("EventBroker#subscribeEvent: type argument must be a string");if("function"!=typeof b)throw new TypeError("EventBroker#subscribeEvent: handler argument must be a function");return f.unsubscribe(a,b,this),f.subscribe(a,b,this)},subscribeEventOnce:function(a,b){if("string"!=typeof a)throw new TypeError("EventBroker#subscribeEventOnce: type argument must be a string");if("function"!=typeof b)throw new TypeError("EventBroker#subscribeEventOnce: handler argument must be a function");return f.unsubscribe(a,b,this),f.subscribeOnce(a,b,this)},unsubscribeEvent:function(a,b){if("string"!=typeof a)throw new TypeError("EventBroker#unsubscribeEvent: type argument must be a string");if("function"!=typeof b)throw new TypeError("EventBroker#unsubscribeEvent: handler argument must be a function");return f.unsubscribe(a,b)},unsubscribeAllEvents:function(){return f.unsubscribe(null,null,this)},publishEvent:function(){var a,b;if(b=arguments[0],a=2<=arguments.length?g.call(arguments,1):[],"string"!=typeof b)throw new TypeError("EventBroker#publishEvent: type argument must be a string");return f.publish.apply(f,[b].concat(g.call(a)))}},"function"==typeof Object.freeze&&Object.freeze(e),d.exports=e}),a.register("chaplin/lib/support",function(a,b,c){"use strict";var d;d={propertyDescriptors:function(){var a,b;if("function"!=typeof Object.defineProperty||"function"!=typeof Object.defineProperties)return!1;try{return b={},Object.defineProperty(b,"foo",{value:"bar"}),"bar"===b.foo}catch(c){return a=c,!1}}()},c.exports=d}),a.register("chaplin/lib/composition",function(b,c,d){"use strict";var e,f,g,h,i,j={}.hasOwnProperty;i=a("underscore"),e=a("backbone"),g=a("chaplin/lib/event_broker"),h=Object.prototype.hasOwnProperty,d.exports=f=function(){function a(a){null!=a&&(this.options=i.extend({},a)),this.item=this,this.initialize(this.options)}return a.extend=e.Model.extend,i.extend(a.prototype,e.Events),i.extend(a.prototype,g),a.prototype.item=null,a.prototype.options=null,a.prototype._stale=!1,a.prototype.initialize=function(){},a.prototype.compose=function(){},a.prototype.check=function(a){return i.isEqual(this.options,a)},a.prototype.stale=function(a){var b,c;if(null==a)return this._stale;this._stale=a;for(c in this)b=this[c],b&&b!==this&&"object"==typeof b&&h.call(b,"stale")&&(b.stale=a)},a.prototype.disposed=!1,a.prototype.dispose=function(){var a,b,c,d,e;if(!this.disposed){for(b in this)j.call(this,b)&&(a=this[b],a&&"function"==typeof a.dispose&&a!==this&&(a.dispose(),delete this[b]));for(this.unsubscribeAllEvents(),this.stopListening(),c=["redirected"],d=0,e=c.length;e>d;d++)b=c[d],delete this[b];return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},a}()}),a.register("chaplin/lib/sync_machine",function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m;for(h="unsynced",f="syncing",e="synced",d="syncStateChange",g={_syncState:h,_previousSyncState:null,syncState:function(){return this._syncState},isUnsynced:function(){return this._syncState===h},isSynced:function(){return this._syncState===e},isSyncing:function(){return this._syncState===f},unsync:function(){var a;((a=this._syncState)===f||a===e)&&(this._previousSync=this._syncState,this._syncState=h,this.trigger(this._syncState,this,this._syncState),this.trigger(d,this,this._syncState))},beginSync:function(){var a;((a=this._syncState)===h||a===e)&&(this._previousSync=this._syncState,this._syncState=f,this.trigger(this._syncState,this,this._syncState),this.trigger(d,this,this._syncState))},finishSync:function(){this._syncState===f&&(this._previousSync=this._syncState,this._syncState=e,this.trigger(this._syncState,this,this._syncState),this.trigger(d,this,this._syncState))},abortSync:function(){this._syncState===f&&(this._syncState=this._previousSync,this._previousSync=this._syncState,this.trigger(this._syncState,this,this._syncState),this.trigger(d,this,this._syncState))}},m=[h,f,e,d],j=function(a){return g[a]=function(b,c){return null==c&&(c=this),this.on(a,b,c),this._syncState===a?b.call(c):void 0}},k=0,l=m.length;l>k;k++)i=m[k],j(i);"function"==typeof Object.freeze&&Object.freeze(g),c.exports=g}),a.register("chaplin/lib/utils",function(b,c,d){"use strict";var e,f,g,h=[].slice,i=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},j={}.hasOwnProperty;g=a("underscore"),e=a("chaplin/lib/support"),f={beget:function(){var a;return"function"==typeof Object.create?Object.create:(a=function(){},function(b){return a.prototype=b,new a})}(),indexOf:function(){return Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:g.indexOf?g.indexOf:void 0}(),isArray:Array.isArray||g.isArray,serialize:function(a){if("function"==typeof a.serialize)return a.serialize();if("function"==typeof a.toJSON)return a.toJSON();throw new TypeError("utils.serialize: Unknown data was passed")},readonly:function(){var a;return e.propertyDescriptors?(a={writable:!1,enumerable:!0,configurable:!1},function(){var b,c,d,e,f;for(b=arguments[0],d=2<=arguments.length?h.call(arguments,1):[],e=0,f=d.length;f>e;e++)c=d[e],a.value=b[c],Object.defineProperty(b,c,a);return!0}):function(){return!1}}(),getPrototypeChain:function(a){var b,c,d,e,f;for(b=[a.constructor.prototype];a=null!=(c=null!=(d=a.constructor)&&null!=(e=d.superclass)?e.prototype:void 0)?c:null!=(f=a.constructor)?f.__super__:void 0;)b.push(a);return b.reverse()},getAllPropertyVersions:function(a,b){var c,d,e,g,h,j;for(d=[],j=f.getPrototypeChain(a),g=0,h=j.length;h>g;g++)c=j[g],e=c[b],e&&i.call(d,e)<0&&d.push(e);return d},upcase:function(a){return a.charAt(0).toUpperCase()+a.substring(1)},escapeRegExp:function(a){return String(a||"").replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},modifierKeyPressed:function(a){return a.shiftKey||a.altKey||a.ctrlKey||a.metaKey},reverse:function(b,c,d){return a("chaplin/mediator").execute("router:reverse",b,c,d)},redirectTo:function(b,c,d){return a("chaplin/mediator").execute("router:route",b,c,d)},querystring:{stringify:function(a){var b,c,d,e,g,h,i,k;e="",g=function(a,b){return null!=b?"&"+a+"="+encodeURIComponent(b):""};for(d in a)if(j.call(a,d))if(h=a[d],c=encodeURIComponent(d),f.isArray(h))for(i=0,k=h.length;k>i;i++)b=h[i],e+=g(c,b);else e+=g(c,h);return e&&e.substring(1)},parse:function(a){var b,c,d,e,f,g,h,i,j;if(f={},!a)return f;for(a=a.slice(a.indexOf("?")+1),e=a.split("&"),h=0,i=e.length;i>h;h++)d=e[h],d.length&&(j=d.split("="),c=j[0],g=j[1],c.length&&(c=decodeURIComponent(c),g=decodeURIComponent(g),b=f[c],b?b.push?b.push(g):f[c]=[b,g]:f[c]=g));return f}}},f.queryParams=f.querystring,"function"==typeof Object.seal&&Object.seal(f),d.exports=f}),a.register("chaplin",function(b,c,d){d.exports={Application:a("chaplin/application"),mediator:a("chaplin/mediator"),Dispatcher:a("chaplin/dispatcher"),Controller:a("chaplin/controllers/controller"),Composer:a("chaplin/composer"),Composition:a("chaplin/lib/composition"),Collection:a("chaplin/models/collection"),Model:a("chaplin/models/model"),Layout:a("chaplin/views/layout"),View:a("chaplin/views/view"),CollectionView:a("chaplin/views/collection_view"),Route:a("chaplin/lib/route"),Router:a("chaplin/lib/router"),EventBroker:a("chaplin/lib/event_broker"),support:a("chaplin/lib/support"),SyncMachine:a("chaplin/lib/sync_machine"),utils:a("chaplin/lib/utils")}});var b=function(b,c){a.register("backbone",function(a,c,d){d.exports=b}),a.register("underscore",function(a,b,d){d.exports=c})};if("function"==typeof define&&define.amd)define(["backbone","underscore"],function(c,d){return b(c,d),a("chaplin")});else if("object"==typeof module&&module&&module.exports)b(require("backbone"),require("underscore")),module.exports=a("chaplin");else{if("function"!=typeof require)throw new Error("Chaplin requires Common.js or AMD modules");b(window.Backbone,window._||window.Backbone.utils),window.Chaplin=a("chaplin")}}();